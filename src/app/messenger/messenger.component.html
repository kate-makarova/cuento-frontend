<div id="pun-main" class="main">
  <div class="main-header">
    <h1><span>Личные сообщения</span></h1>
  </div>

  <div id="pm" class="category">
    <div class="maintitle">
      <div class="conl">
        <p>Собеседник: <strong>{{ activeUser?.username }}</strong></p>
      </div>
      <div class="conr">
        <input type="text" (input)="onSearch($event)" placeholder="Поиск в сообщениях..." class="pm-search">
      </div>
      <div class="clearer"></div>
    </div>

    <div class="main-content pm-container">
      <div class="pm-sidebar">
        <div class="main-item">
          @for (chat of chatList; track chat.id) {
            <div class="pm-contact" [class.active]="chat.id === activeUser?.id" (click)="selectUser(chat)">
              <div class="icon"><div class="nosize">1</div></div>
              <div class="tclcon">
                <strong>{{ chat.userName }}</strong>
                <div class="byuser">{{ chat.lastMessage }}</div>
              </div>
            </div>
          }
        </div>
      </div>

      <div class="pm-history">
        <div class="main-item">
          <div class="history-scroll" #scrollContainer>
            @for (msg of messages; track msg.id) {
              <div class="post" [class.altstyle]="msg.isMe">
                <div class="container">
                  <div class="post-main">
                    <div class="post-body">
                      <div class="post-box">
                        <div class="post-content">
                          <p [innerHTML]="highlightMatch(msg.text)"></p>
                        </div>
                      </div>
                      <p class="post-metadata"><span>{{ msg.time }}</span></p>
                    </div>
                  </div>
                </div>
              </div>
            }
          </div>

          <div class="pm-input">
            <div class="textarea-wrapper">
              <textarea #chatInput (keydown.enter)="handleSend()" placeholder="Ваше сообщение..."></textarea>
            </div>
            <div class="buttons">
              <input type="button" class="button" value="Отправить" (click)="handleSend()">
              <div class="clearer"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
</div>
